// Do not edit this file; automatically generated by build.py.
'use strict';


// Copyright 2012 Google Inc.  Apache License 2.0
Blockly.TIBasic=new Blockly.Generator("TIBasic");Blockly.TIBasic.INDENT="";Blockly.TIBasic.addReservedWords("Blockly,Define,Pgrm,EndPgrm,If,Then,ElseIf,EndIf,Disp,While,EndWhile,not,and,or,xor,nor,nand,&,#,!,%,text","undef","count","augment");Blockly.TIBasic.ORDER_ATOMIC=0;Blockly.TIBasic.ORDER_INDIRECTION=1;Blockly.TIBasic.ORDER_FUNCTION_CALL=2;Blockly.TIBasic.ORDER_POST_OPERATORS=3;Blockly.TIBasic.ORDER_EXPONENTIATION=4;Blockly.TIBasic.ORDER_UNARY_NEGATION=5;
Blockly.TIBasic.ORDER_CONCATENATION=6;Blockly.TIBasic.ORDER_MULTIPLICATIVE=7;Blockly.TIBasic.ORDER_ADDITIVE=8;Blockly.TIBasic.ORDER_RELATIONAL=9;Blockly.TIBasic.ORDER_LOGICAL_NOT=10;Blockly.TIBasic.ORDER_LOGICAL_AND=11;Blockly.TIBasic.ORDER_LOGICAL_OR=12;Blockly.TIBasic.ORDER_OTHER_LOGIC=13;Blockly.TIBasic.ORDER_IMPLICATION=14;Blockly.TIBasic.ORDER_D_IMPLICATION=15;Blockly.TIBasic.ORDER_CONSTRAINT=16;Blockly.TIBasic.ORDER_ASSIGNMENT=17;Blockly.TIBasic.ORDER_NONE=99;
Blockly.TIBasic.init=function(a){Blockly.TIBasic.definitions_=Object.create(null);Blockly.TIBasic.functionNames_=Object.create(null);Blockly.TIBasic.variableDB_?Blockly.TIBasic.variableDB_.reset():Blockly.TIBasic.variableDB_=new Blockly.Names(Blockly.TIBasic.RESERVED_WORDS_);var b=[];a=a.variableList;if(a.length){for(var c=0;c<a.length;c++)b[c]=Blockly.TIBasic.variableDB_.getName(a[c],Blockly.Variables.NAME_TYPE);Blockly.TIBasic.definitions_.variables="Local "+b.join(", ")+":"}};
Blockly.TIBasic.finish=function(a){var b=[],c;for(c in Blockly.TIBasic.definitions_)b.push(Blockly.TIBasic.definitions_[c]);delete Blockly.TIBasic.definitions_;delete Blockly.TIBasic.functionNames_;Blockly.TIBasic.variableDB_.reset();return b.join(":")+a};Blockly.TIBasic.scrubNakedValue=function(a){return a+":"};Blockly.TIBasic.quote_=function(a){a=a.replace(/"/g,'""');return'"'+a+'"'};
Blockly.TIBasic.scrub_=function(a,b){var c="";if(!a.outputConnection||!a.outputConnection.targetConnection){var d=a.getCommentText();(d=Blockly.utils.wrap(d,Blockly.TIBasic.COMMENT_WRAP-2))&&(c+=Blockly.TIBasic.prefixLines(d+":\n","\u00a9 "));for(var e=0;e<a.inputList.length;e++)a.inputList[e].type==Blockly.INPUT_VALUE&&(d=a.inputList[e].connection.targetBlock())&&(d=Blockly.TIBasic.allNestedComments(d))&&(c+=Blockly.TIBasic.prefixLines(d,"\u00a9 "))}e=a.nextConnection&&a.nextConnection.targetBlock();
e=Blockly.TIBasic.blockToCode(e);return c+b+e};
Blockly.TIBasic.getAdjusted=function(a,b,c,d,e){c=c||0;e=e||Blockly.TIBasic.ORDER_NONE;a.workspace.options.oneBasedIndex||c++;var f=a.workspace.options.oneBasedIndex?"1":"0";a=0<c?Blockly.TIBasic.valueToCode(a,b,Blockly.TIBasic.ORDER_ADDITIVE)||f:0>c?Blockly.TIBasic.valueToCode(a,b,Blockly.TIBasic.ORDER_ADDITIVE)||f:d?Blockly.TIBasic.valueToCode(a,b,Blockly.TIBasic.ORDER_UNARY_NEGATION)||f:Blockly.TIBasic.valueToCode(a,b,e)||f;if(Blockly.isNumber(a))a=parseFloat(a)+c,d&&(a=-a);else{if(0<c){a=a+" + "+
c;var g=Blockly.TIBasic.ORDER_ADDITIVE}else 0>c&&(a=a+" - "+-c,g=Blockly.TIBasic.ORDER_ADDITIVE);d&&(a=c?"-("+a+")":"-"+a,g=Blockly.TIBasic.ORDER_UNARY_NEGATION);g=Math.floor(g);e=Math.floor(e);g&&e>=g&&(a="("+a+")")}return a};Blockly.TIBasic.colour={};Blockly.TIBasic.colour_picker=function(a){return["'"+a.getFieldValue("COLOUR")+"'",Blockly.TIBasic.ORDER_ATOMIC]};Blockly.TIBasic.colour_random=function(a){return[Blockly.TIBasic.provideFunction_("colourRandom",["function "+Blockly.TIBasic.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",Blockly.TIBasic.ORDER_FUNCTION_CALL]};
Blockly.TIBasic.colour_rgb=function(a){var b=Blockly.TIBasic.valueToCode(a,"RED",Blockly.TIBasic.ORDER_COMMA)||0,c=Blockly.TIBasic.valueToCode(a,"GREEN",Blockly.TIBasic.ORDER_COMMA)||0;a=Blockly.TIBasic.valueToCode(a,"BLUE",Blockly.TIBasic.ORDER_COMMA)||0;return[Blockly.TIBasic.provideFunction_("colourRgb",["function "+Blockly.TIBasic.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;",
"  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+b+", "+c+", "+a+")",Blockly.TIBasic.ORDER_FUNCTION_CALL]};
Blockly.TIBasic.colour_blend=function(a){var b=Blockly.TIBasic.valueToCode(a,"COLOUR1",Blockly.TIBasic.ORDER_COMMA)||"'#000000'",c=Blockly.TIBasic.valueToCode(a,"COLOUR2",Blockly.TIBasic.ORDER_COMMA)||"'#000000'";a=Blockly.TIBasic.valueToCode(a,"RATIO",Blockly.TIBasic.ORDER_COMMA)||.5;return[Blockly.TIBasic.provideFunction_("colourBlend",["function "+Blockly.TIBasic.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);",
"  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);",
"  return '#' + r + g + b;","}"])+"("+b+", "+c+", "+a+")",Blockly.TIBasic.ORDER_FUNCTION_CALL]};Blockly.TIBasic.innovator_io={};Blockly.TIBasic.innovator_io_light_ext=function(a){var b=a.getFieldValue("STATE");a.getField("TIME")?a=String(Number(a.getFieldValue("TIME"))):(a=Blockly.TIBasic.valueToCode(a,"TIME",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",Blockly.isNumber(a)||(a="eval("+String(a)+")"));b='Send("SET LIGHT '+b;"0"!==a&&(b+=" TIME "+a);return b+'"):'};Blockly.TIBasic.innovator_io_light=Blockly.TIBasic.innovator_io_light_ext;
Blockly.TIBasic.innovator_io_wait=function(a){return"Wait "+(a.getField("TIME")?String(Number(a.getFieldValue("TIME"))):Blockly.TIBasic.valueToCode(a,"TIME",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0")+":"};
Blockly.TIBasic.innovator_io_sound_ext=function(a){if(a.getField("FREQUENCY"))var b=String(Number(a.getFieldValue("FREQUENCY")));else b=Blockly.TIBasic.valueToCode(a,"FREQUENCY",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",Blockly.isNumber(b)||(b="eval("+String(b)+")");a.getField("TIME")?a=String(Number(a.getFieldValue("TIME"))):(a=Blockly.TIBasic.valueToCode(a,"TIME",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",Blockly.isNumber(a)||(a="eval("+String(a)+")"));b='Send("SET SOUND '+b;"0"!==a&&(b+=" TIME "+a);return b+
'"):'};Blockly.TIBasic.innovator_io_sound=Blockly.TIBasic.innovator_io_sound_ext;Blockly.TIBasic.innovator_io_read=function(a){var b=a.getFieldValue("DATA");a=Blockly.TIBasic.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);return'Send("READ '+b+'"):'+("Get("+a+"):")};Blockly.TIBasic.innovator_io_connect=function(a){var b=a.getFieldValue("SENSOR"),c=String(Number(a.getFieldValue("INDEX")));a=a.getFieldValue("PORT");return'Send("CONNECT '+b+" "+c+" "+a+'"):'};
Blockly.TIBasic.innovator_io_disconnect=function(a){var b=a.getFieldValue("SENSOR");a=String(Number(a.getFieldValue("INDEX")));return'Send("DISCONNECT '+b+" "+a+'"):'};Blockly.TIBasic.innovator_io_led=function(a){var b=String(Number(a.getFieldValue("INDEX")));a.getField("TIME")?a=String(Number(a.getFieldValue("VALUE"))):(a=Blockly.TIBasic.valueToCode(a,"VALUE",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",Blockly.isNumber(a)||(a="eval("+String(a)+")"));return'Send("SET LED '+b+" "+a+'"):'};
Blockly.TIBasic.innovator_io_color=function(a){if(a.getField("RED"))var b=String(Number(a.getFieldValue("RED")));else b=Blockly.TIBasic.valueToCode(a,"RED",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",Blockly.isNumber(b)||(b="eval("+String(b)+")");if(a.getField("GREEN"))var c=String(Number(a.getFieldValue("GREEN")));else c=Blockly.TIBasic.valueToCode(a,"GREEN",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",Blockly.isNumber(c)||(c="eval("+String(c)+")");a.getField("BLUE")?a=String(Number(a.getFieldValue("BLUE"))):
(a=Blockly.TIBasic.valueToCode(a,"BLUE",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",Blockly.isNumber(a)||(a="eval("+String(a)+")"));return'Send("SET COLOR '+b+" "+c+" "+a+'"):'};Blockly.TIBasic.lists={};Blockly.TIBasic.lists_create_empty=function(a){return["{}",Blockly.TIBasic.ORDER_ATOMIC]};Blockly.TIBasic.lists_create_with=function(a){for(var b=Array(a.itemCount_),c=0;c<a.itemCount_;c++)b[c]=Blockly.TIBasic.valueToCode(a,"ADD"+c,Blockly.TIBasic.ORDER_ATOMIC)||"undef";return["{"+b.join(",")+"}",Blockly.TIBasic.ORDER_ATOMIC]};Blockly.TIBasic.lists_length=function(a){return["dim("+(Blockly.TIBasic.valueToCode(a,"VALUE",Blockly.TIBasic.ORDER_ATOMIC)||"[]")+")",Blockly.TIBasic.ORDER_ATOMIC]};
Blockly.TIBasic.lists_isEmpty=function(a){return["dim("+(Blockly.TIBasic.valueToCode(a,"VALUE",Blockly.TIBasic.ORDER_ATOMIC)||"[]")+")=0",Blockly.TIBasic.ORDER_LOGICAL_NOT]};
Blockly.TIBasic.lists_setIndex=function(a){var b=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_ATOMIC)||"[]",c=a.getFieldValue("MODE")||"GET",d=a.getFieldValue("WHERE")||"FROM_START",e=Blockly.TIBasic.valueToCode(a,"TO",Blockly.TIBasic.ORDER_ASSIGNMENT)||"undef";switch(d){case "FIRST":if("SET"==c)return b+"[1] := "+e+":";if("INSERT"==c)return b+":=augment({"+e+"},"+b+"):";break;case "LAST":if("SET"==c)return b.match(/^\w+$/)?c="":(c=Blockly.TIBasic.variableDB_.getDistinctName("tmpList",
Blockly.Variables.NAME_TYPE),a="var "+c+" = "+b+";\n",b=c,c=a),c+(b+"[dim("+b+")] := "+e+":");if("INSERT"==c)return b+":=augment("+b+",{"+e+"}):";break;case "FROM_START":d=Blockly.TIBasic.variableDB_.getDistinctName("tempList",Blockly.Variables.NAME_TYPE);a=Blockly.TIBasic.getAdjusted(a,"AT");if("SET"==c)return b+"["+a+"] := "+e+":";if("INSERT"==c)return d+":=augment(mid("+b+",1,"+(a-1)+"),{"+e+"}):"+(b+":=augment("+d+",mid("+b+","+a+")):");break;case "FROM_END":a=Blockly.TIBasic.getAdjusted(a,"AT",
1,!1,Blockly.TIBasic.ORDER_ADDITIVE);d=Blockly.TIBasic.variableDB_.getDistinctName("tempList",Blockly.Variables.NAME_TYPE);if("SET"==c)return b+"[dim("+b+") - "+(a-2)+"] := "+e+":";if("INSERT"==c)return d+":=augment(mid("+b+",1,dim("+b+") - "+(a-2)+"),{"+e+"}):"+(b+":=augment("+d+",mid("+b+",dim("+b+") - "+(a-3)+")):")}throw"Unhandled combination (lists_setIndex).";};
Blockly.TIBasic.lists_getSublist=function(a){var b=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_ATOMIC)||"[]",c=a.getFieldValue("WHERE1"),d=a.getFieldValue("WHERE2");if("FIRST"==c&&"LAST"==d)b+=".slice(0)";else if(b.match(/^\w+$/)||"FROM_END"!=c&&"FROM_START"==d){switch(c){case "FROM_START":var e=Blockly.TIBasic.getAdjusted(a,"AT1");break;case "FROM_END":e=Blockly.TIBasic.getAdjusted(a,"AT1",1,!1,Blockly.TIBasic.ORDER_ADDITIVE);e="dim("+b+") - "+e;break;case "FIRST":e="0";break;default:throw"Unhandled option (lists_getSublist).";
}switch(d){case "FROM_START":a=Blockly.TIBasic.getAdjusted(a,"AT2",1);break;case "FROM_END":a=Blockly.TIBasic.getAdjusted(a,"AT2",0,!1,Blockly.TIBasic.ORDER_ADDITIVE);a="dim("+b+") - "+a;break;case "LAST":a=b+".length";break;default:throw"Unhandled option (lists_getSublist).";}b="mid("+b+","+e+","+a-e+")"}else{e=Blockly.TIBasic.getAdjusted(a,"AT1");a=Blockly.TIBasic.getAdjusted(a,"AT2");var f=Blockly.TIBasic.lists.getIndex_,g={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},b=
Blockly.TIBasic.provideFunction_("subsequence"+g[c]+g[d],["function "+Blockly.TIBasic.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==c||"FROM_START"==c?", at1":"")+("FROM_END"==d||"FROM_START"==d?", at2":"")+") {","  var start = "+f("sequence",c,"at1")+";","  var end = "+f("sequence",d,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+b+("FROM_END"==c||"FROM_START"==c?", "+e:"")+("FROM_END"==d||"FROM_START"==d?", "+a:"")+")"}return[b,Blockly.TIBasic.ORDER_FUNCTION_CALL]};
Blockly.TIBasic.lists_sort=function(a){var b=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_FUNCTION_CALL)||"[]";return 1===("1"===a.getFieldValue("DIRECTION")?1:-1)?"sortA("+b+")":"sortD("+b+")"};Blockly.TIBasic.logic={};Blockly.TIBasic.controls_if=function(a){var b=0,c="",d,e;do e=Blockly.TIBasic.valueToCode(a,"IF"+b,Blockly.TIBasic.ORDER_NONE)||"false",d=Blockly.TIBasic.statementToCode(a,"DO"+b),c+=(0<b?"ElseIf ":"If ")+e+" Then:"+d,++b;while(a.getInput("IF"+b));a.getInput("ELSE")&&(d=Blockly.TIBasic.statementToCode(a,"ELSE"),c+="Else:"+d);return c+"EndIf:"};Blockly.TIBasic.controls_ifelse=Blockly.TIBasic.controls_if;
Blockly.TIBasic.logic_compare=function(a){var b={EQ:"=",NEQ:"/=",LT:"<",LTE:"<=",GT:">",GTE:">="}[a.getFieldValue("OP")],c=Blockly.TIBasic.ORDER_RELATIONAL,d=Blockly.TIBasic.valueToCode(a,"A",c)||"0";a=Blockly.TIBasic.valueToCode(a,"B",c)||"0";return[d+" "+b+" "+a,c]};
Blockly.TIBasic.logic_operation=function(a){var b="AND"==a.getFieldValue("OP")?"and":"or",c="and"==b?Blockly.TIBasic.ORDER_LOGICAL_AND:Blockly.TIBasic.ORDER_LOGICAL_OR,d=Blockly.TIBasic.valueToCode(a,"A",c);a=Blockly.TIBasic.valueToCode(a,"B",c);if(d||a){var e="and"==b?"true":"false";d||(d=e);a||(a=e)}else a=d="false";return[d+" "+b+" "+a,c]};Blockly.TIBasic.logic_negate=function(a){var b=Blockly.TIBasic.ORDER_LOGICAL_NOT;return["not("+(Blockly.TIBasic.valueToCode(a,"BOOL",b)||"true")+")",b]};
Blockly.TIBasic.logic_boolean=function(a){return["TRUE"==a.getFieldValue("BOOL")?"true":"false",Blockly.TIBasic.ORDER_ATOMIC]};Blockly.TIBasic.logic_null=function(a){return["undef",Blockly.TIBasic.ORDER_ATOMIC]};
Blockly.TIBasic.logic_ternary=function(a){var b=Blockly.TIBasic.valueToCode(a,"IF",Blockly.TIBasic.ORDER_FUNCTION_CALL)||"false",c=Blockly.TIBasic.valueToCode(a,"THEN",Blockly.TIBasic.ORDER_FUNCTION_CALL)||"undef";a=Blockly.TIBasic.valueToCode(a,"ELSE",Blockly.TIBasic.ORDER_FUNCTION_CALL)||"undef";return["ifFn("+b+","+c+","+a+")",Blockly.TIBasic.ORDER_FUNCTION_CALL]};Blockly.TIBasic.loops={};
Blockly.TIBasic.controls_repeat_ext=function(a){var b=a.getField("TIMES")?String(Number(a.getFieldValue("TIMES"))):Blockly.TIBasic.valueToCode(a,"TIMES",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",c=Blockly.TIBasic.statementToCode(a,"DO"),c=Blockly.TIBasic.addLoopTrap(c,a.id);a="";var d=Blockly.TIBasic.variableDB_.getDistinctName("loops",Blockly.Variables.NAME_TYPE);a+="Local "+d;var e=b;b.match(/^\w+$/)||Blockly.isNumber(b)?a+=":":(e=Blockly.TIBasic.variableDB_.getDistinctName("repeat_end",Blockly.Variables.NAME_TYPE),
a=a+(","+e+":")+(""+e+":="+b+":"));return a+("For "+d+",1,"+e+":"+c+"EndFor:")};Blockly.TIBasic.controls_repeat=Blockly.TIBasic.controls_repeat_ext;Blockly.TIBasic.controls_whileUntil=function(a){var b="UNTIL"==a.getFieldValue("MODE"),c=Blockly.TIBasic.valueToCode(a,"BOOL",b?Blockly.TIBasic.ORDER_LOGICAL_NOT:Blockly.TIBasic.ORDER_NONE)||"false",d=Blockly.TIBasic.statementToCode(a,"DO"),d=Blockly.TIBasic.addLoopTrap(d,a.id);b&&(c="not "+c);return"While "+c+":"+d+"EndWhile:"};
Blockly.TIBasic.controls_for=function(a){var b=Blockly.TIBasic.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),c=Blockly.TIBasic.valueToCode(a,"FROM",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",d=Blockly.TIBasic.valueToCode(a,"TO",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0",e=Blockly.TIBasic.valueToCode(a,"BY",Blockly.TIBasic.ORDER_ASSIGNMENT)||"1",f=Blockly.TIBasic.statementToCode(a,"DO"),f=Blockly.TIBasic.addLoopTrap(f,a.id);if(Blockly.isNumber(c)&&Blockly.isNumber(d)&&Blockly.isNumber(e)){var g=
parseFloat(c)<=parseFloat(d);a="For "+b+","+c+","+d;b=Math.abs(parseFloat(e));g||(b=-b);1!=b&&(a+=","+b);a+=":"+f+"EndFor:"}else{var g=Blockly.TIBasic.variableDB_.getDistinctName(b+"_inc",Blockly.Variables.NAME_TYPE),h=Blockly.TIBasic.variableDB_.getDistinctName(b+"_start",Blockly.Variables.NAME_TYPE),k=Blockly.TIBasic.variableDB_.getDistinctName(b+"_end",Blockly.Variables.NAME_TYPE);Blockly.TIBasic.variableDB_.getDistinctName("swap",Blockly.Variables.NAME_TYPE);a="Local "+g+","+h+","+k+":"+(g+" := ");
a=Blockly.isNumber(e)?a+(Math.abs(e)+":"):a+("abs("+e+"):");a=a+(h+" := "+c+":")+(k+" := "+d+":");a+="If "+h+" > "+k+" Then:";a+=g+" := -"+g+":";a+="EndIf:";a+="For "+b+","+h+","+k+","+g+":"+f+"EndFor:"}return a};
Blockly.TIBasic.controls_forEach=function(a){var b=Blockly.TIBasic.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),c=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_ASSIGNMENT)||"[]",d=Blockly.TIBasic.statementToCode(a,"DO"),d=Blockly.TIBasic.addLoopTrap(d,a.id);a="";var e=c;c.match(/^\w+$/)||(e=Blockly.TIBasic.variableDB_.getDistinctName(b+"_list",Blockly.Variables.NAME_TYPE),a+="var "+e+" = "+c+";\n");c=Blockly.TIBasic.variableDB_.getDistinctName(b+"_index",Blockly.Variables.NAME_TYPE);
d=Blockly.TIBasic.INDENT+b+" = "+e+"["+c+"];\n"+d;return a+("for (var "+c+" in "+e+") {\n"+d+"}\n")};Blockly.TIBasic.controls_flow_statements=function(a){switch(a.getFieldValue("FLOW")){case "BREAK":return"Exit:";case "CONTINUE":return"Cycle:"}throw"Unknown flow statement.";};Blockly.TIBasic.math={};Blockly.TIBasic.math_number=function(a){return[parseFloat(a.getFieldValue("NUM")),Blockly.TIBasic.ORDER_ATOMIC]};
Blockly.TIBasic.math_arithmetic=function(a){var b={ADD:[" + ",Blockly.TIBasic.ORDER_ADDITIVE],MINUS:[" - ",Blockly.TIBasic.ORDER_ADDITIVE],MULTIPLY:[" * ",Blockly.TIBasic.ORDER_MULTIPLICATIVE],DIVIDE:[" / ",Blockly.TIBasic.ORDER_MULTIPLICATIVE],POWER:[" ^ ",Blockly.TIBasic.ORDER_EXPONENTIATION]}[a.getFieldValue("OP")],c=b[0],b=b[1],d=Blockly.TIBasic.valueToCode(a,"A",b)||"0";a=Blockly.TIBasic.valueToCode(a,"B",b)||"0";return[d+c+a,b]};
Blockly.TIBasic.math_single=function(a){var b=a.getFieldValue("OP"),c;if("NEG"==b)return a=Blockly.TIBasic.valueToCode(a,"NUM",Blockly.TIBasic.ORDER_UNARY_NEGATION)||"0","-"==a[0]&&(a=" "+a),["-"+a,Blockly.TIBasic.ORDER_UNARY_NEGATION];a="SIN"==b||"COS"==b||"TAN"==b?Blockly.TIBasic.valueToCode(a,"NUM",Blockly.TIBasic.ORDER_MULTIPLICATIVE)||"0":Blockly.TIBasic.valueToCode(a,"NUM",Blockly.TIBasic.ORDER_NONE)||"0";switch(b){case "ABS":c="abs("+a+")";break;case "ROOT":c="sqrt("+a+")";break;case "LN":c=
"ln("+a+")";break;case "EXP":c="exp("+a+")";break;case "POW10":c="10^"+a;break;case "SIN":c="sin("+a+")";break;case "COS":c="cos("+a+")";break;case "TAN":c="tan("+a+")";break;case "ASIN":c="arcsin("+a+")";break;case "ACOS":c="arccos("+a+")";break;case "ATAN":c="arctan("+a+")"}return c?[c,Blockly.TIBasic.ORDER_FUNCTION_CALL]:[c,Blockly.TIBasic.ORDER_MULTIPLICATIVE]};
Blockly.TIBasic.math_constant=function(a){return{PI:["pi",Blockly.TIBasic.ORDER_MEMBER],E:["@e",Blockly.TIBasic.ORDER_MEMBER],GOLDEN_RATIO:["(1 + sqrt(5)) / 2",Blockly.TIBasic.ORDER_DIVISION],SQRT2:["sqrt(2)",Blockly.TIBasic.ORDER_MEMBER],SQRT1_2:["sqrt(1/2)",Blockly.TIBasic.ORDER_MEMBER],INFINITY:["infinity",Blockly.TIBasic.ORDER_ATOMIC]}[a.getFieldValue("CONSTANT")]};Blockly.TIBasic.math_round=Blockly.TIBasic.math_single;Blockly.TIBasic.math_trig=Blockly.TIBasic.math_single;
Blockly.TIBasic.math_on_list=function(a){var b=a.getFieldValue("OP");switch(b){case "SUM":a=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_MEMBER)||"{}";a="sum("+a+")";break;case "MIN":a=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_COMMA)||"{}";a="min("+a+")";break;case "MAX":a=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_COMMA)||"{}";a="max("+a+")";break;case "AVERAGE":a=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_COMMA)||"{}";a="mean("+a+")";
break;case "MEDIAN":a=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_COMMA)||"{}";a="median("+a+")";break;case "STD_DEV":a=Blockly.TIBasic.valueToCode(a,"LIST",Blockly.TIBasic.ORDER_COMMA)||"{}";a="stdDev("+a+")";break;default:throw"Unknown operator: "+b;}return[a,Blockly.TIBasic.ORDER_FUNCTION_CALL]};
Blockly.TIBasic.math_modulo=function(a){var b=Blockly.TIBasic.valueToCode(a,"DIVIDEND",Blockly.TIBasic.ORDER_MULTIPLICATIVE)||"0";a=Blockly.TIBasic.valueToCode(a,"DIVISOR",Blockly.TIBasic.ORDER_MULTIPLICATIVE)||"0";return["mod("+b+", "+a+")",Blockly.TIBasic.ORDER_MULTIPLICATIVE]};
Blockly.TIBasic.math_random_int=function(a){var b=Blockly.TIBasic.valueToCode(a,"FROM",Blockly.TIBasic.ORDER_ATOMIC)||"0";a=Blockly.TIBasic.valueToCode(a,"TO",Blockly.TIBasic.ORDER_ATOMIC)||"0";return["randInt("+b+", "+a+")",Blockly.TIBasic.ORDER_FUNCTION_CALL]};Blockly.TIBasic.math_random_float=function(a){return["rand()",Blockly.TIBasic.ORDER_FUNCTION_CALL]};Blockly.TIBasic.procedures={};
Blockly.TIBasic.procedures_defreturn=function(a){var b=Blockly.TIBasic.variableDB_.getName(a.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),c=Blockly.TIBasic.statementToCode(a,"STACK");Blockly.TIBasic.STATEMENT_PREFIX&&(c=Blockly.TIBasic.prefixLines(Blockly.TIBasic.STATEMENT_PREFIX.replace(/%1/g,"'"+a.id+"'"),Blockly.TIBasic.INDENT)+c);Blockly.TIBasic.INFINITE_LOOP_TRAP&&(c=Blockly.TIBasic.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+a.id+"'")+c);var d=Blockly.TIBasic.valueToCode(a,"RETURN",Blockly.TIBasic.ORDER_NONE)||
"";d&&(d="  return "+d+";\n");for(var e=[],f=0;f<a.arguments_.length;f++)e[f]=Blockly.TIBasic.variableDB_.getName(a.arguments_[f],Blockly.Variables.NAME_TYPE);c="function "+b+"("+e.join(", ")+") {\n"+c+d+"}";c=Blockly.TIBasic.scrub_(a,c);Blockly.TIBasic.definitions_["%"+b]=c;return null};Blockly.TIBasic.procedures_defnoreturn=Blockly.TIBasic.procedures_defreturn;
Blockly.TIBasic.procedures_callreturn=function(a){for(var b=Blockly.TIBasic.variableDB_.getName(a.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),c=[],d=0;d<a.arguments_.length;d++)c[d]=Blockly.TIBasic.valueToCode(a,"ARG"+d,Blockly.TIBasic.ORDER_COMMA)||"null";return[b+"("+c.join(", ")+")",Blockly.TIBasic.ORDER_FUNCTION_CALL]};
Blockly.TIBasic.procedures_callnoreturn=function(a){for(var b=Blockly.TIBasic.variableDB_.getName(a.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),c=[],d=0;d<a.arguments_.length;d++)c[d]=Blockly.TIBasic.valueToCode(a,"ARG"+d,Blockly.TIBasic.ORDER_COMMA)||"null";return b+"("+c.join(", ")+");\n"};
Blockly.TIBasic.procedures_ifreturn=function(a){var b="if ("+(Blockly.TIBasic.valueToCode(a,"CONDITION",Blockly.TIBasic.ORDER_NONE)||"false")+") {\n";a.hasReturnValue_?(a=Blockly.TIBasic.valueToCode(a,"VALUE",Blockly.TIBasic.ORDER_NONE)||"null",b+="  return "+a+";\n"):b+="  return;\n";return b+"}\n"};Blockly.TIBasic.texts={};var isString=function(a,b){return"string("+value+")"};Blockly.TIBasic.text=function(a){return[Blockly.TIBasic.quote_(a.getFieldValue("TEXT")),Blockly.TIBasic.ORDER_ATOMIC]};
Blockly.TIBasic.text_join=function(a){switch(a.itemCount_){case 0:return['""',Blockly.TIBasic.ORDER_ATOMIC];case 1:return["string("+(Blockly.TIBasic.valueToCode(a,"ADD0",Blockly.TIBasic.ORDER_NONE)||'""')+")",Blockly.TIBasic.ORDER_FUNCTION_CALL];case 2:var b=Blockly.TIBasic.valueToCode(a,"ADD0",Blockly.TIBasic.ORDER_NONE)||'""';a=Blockly.TIBasic.valueToCode(a,"ADD1",Blockly.TIBasic.ORDER_NONE)||'""';return["string("+b+") & string("+a+")",Blockly.TIBasic.ORDER_ADDITIVE];default:for(var b=Array(a.itemCount_),
c=0;c<a.itemCount_;c++)b[c]="string("+Blockly.TIBasic.valueToCode(a,"ADD"+c,Blockly.TIBasic.ORDER_NONE)+")"||'""';a=b.join(" & ");return[a,Blockly.TIBasic.ORDER_FUNCTION_CALL]}};Blockly.TIBasic.text_append=function(a){var b=Blockly.TIBasic.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);a=Blockly.TIBasic.valueToCode(a,"TEXT",Blockly.TIBasic.ORDER_NONE)||"''";return b+" := string("+b+") & string("+a+"):"};
Blockly.TIBasic.text_length=function(a){return["dim("+(Blockly.TIBasic.valueToCode(a,"VALUE",Blockly.TIBasic.ORDER_FUNCTION_CALL)||"''")+")",Blockly.TIBasic.ORDER_ATOMIC]};Blockly.TIBasic.text_isEmpty=function(a){return["!"+(Blockly.TIBasic.valueToCode(a,"VALUE",Blockly.TIBasic.ORDER_MEMBER)||"''")+".length",Blockly.TIBasic.ORDER_LOGICAL_NOT]};
Blockly.TIBasic.text_indexOf=function(a){var b="FIRST"==a.getFieldValue("END")?"indexOf":"lastIndexOf",c=Blockly.TIBasic.valueToCode(a,"FIND",Blockly.TIBasic.ORDER_NONE)||"''",b=(Blockly.TIBasic.valueToCode(a,"VALUE",Blockly.TIBasic.ORDER_MEMBER)||"''")+"."+b+"("+c+")";return a.workspace.options.oneBasedIndex?[b+" + 1",Blockly.TIBasic.ORDER_ADDITION]:[b,Blockly.TIBasic.ORDER_FUNCTION_CALL]};
Blockly.TIBasic.text_charAt=function(a){var b=a.getFieldValue("WHERE")||"FROM_START",c=Blockly.TIBasic.valueToCode(a,"VALUE","RANDOM"==b?Blockly.TIBasic.ORDER_NONE:Blockly.TIBasic.ORDER_ATOMIC)||"''";switch(b){case "FIRST":return["left("+c+", 1)",Blockly.TIBasic.ORDER_FUNCTION_CALL];case "LAST":return["right("+c+", 1)",Blockly.TIBasic.ORDER_FUNCTION_CALL];case "FROM_START":return a=Blockly.TIBasic.getAdjusted(a,"AT"),["mid("+c+", "+a+", 1)",Blockly.TIBasic.ORDER_FUNCTION_CALL];case "FROM_END":return a=
Blockly.TIBasic.getAdjusted(a,"AT",0,!0),["mid("+c+", dim("+c+")"+a+", 1)",Blockly.TIBasic.ORDER_FUNCTION_CALL];case "RANDOM":return["mid("+c+", randInt(1, dim("+c+")), 1)",Blockly.TIBasic.ORDER_FUNCTION_CALL]}throw"Unhandled option (text_charAt).";};
Blockly.TIBasic.text_getSubstring=function(a){var b=Blockly.TIBasic.valueToCode(a,"STRING",Blockly.TIBasic.ORDER_FUNCTION_CALL)||'""',c=a.getFieldValue("WHERE1"),d=a.getFieldValue("WHERE2");if("FIRST"!=c||"LAST"!=d)if(b.match(/^'?\w+'?$/)||"FROM_END"!=c&&"LAST"!=c&&"FROM_END"!=d&&"LAST"!=d){switch(c){case "FROM_START":var e=Blockly.TIBasic.getAdjusted(a,"AT1");break;case "FROM_END":e=Blockly.TIBasic.getAdjusted(a,"AT1",1,!1,Blockly.TIBasic.ORDER_SUBTRACTION);e="dim("+b+")"+e;break;case "FIRST":e=
"0";break;default:throw"Unhandled option (text_getSubstring).";}switch(d){case "FROM_START":a=Blockly.TIBasic.getAdjusted(a,"AT2",1);break;case "FROM_END":a=Blockly.TIBasic.getAdjusted(a,"AT2",0,!1,Blockly.TIBasic.ORDER_SUBTRACTION);a="dim("+b+")"+a;break;case "LAST":a="dim("+b+")";break;default:throw"Unhandled option (text_getSubstring).";}b="mid("+b+","+e+", "+(a-e)+")"}else{e=Blockly.TIBasic.getAdjusted(a,"AT1");a=Blockly.TIBasic.getAdjusted(a,"AT2");var f=Blockly.TIBasic.text.getIndex_,g={FIRST:"First",
LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},b=Blockly.TIBasic.provideFunction_("subsequence"+g[c]+g[d],["function "+Blockly.TIBasic.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==c||"FROM_START"==c?", at1":"")+("FROM_END"==d||"FROM_START"==d?", at2":"")+") {","  var start = "+f("sequence",c,"at1")+";","  var end = "+f("sequence",d,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+b+("FROM_END"==c||"FROM_START"==c?", "+e:"")+("FROM_END"==d||"FROM_START"==d?", "+a:"")+
")"}return[b,Blockly.TIBasic.ORDER_FUNCTION_CALL]};Blockly.TIBasic.text_print=function(a){return"Disp "+(Blockly.TIBasic.valueToCode(a,"TEXT",Blockly.TIBasic.ORDER_NONE)||'""')+":"};
Blockly.TIBasic.tibasic_text_prompt=function(a){var b=a.getFieldValue("TYPES");console.log(b);var c=Blockly.TIBasic.valueToCode(a,"PROMPT",Blockly.TIBasic.ORDER_NONE)||'""';a=Blockly.TIBasic.variableDB_.getName(a.getFieldValue("USERINPUT"),Blockly.Variables.NAME_TYPE);return("TEXT"===b?"RequestStr ":"Request ")+c+", "+a+":"};Blockly.TIBasic.variables={};Blockly.TIBasic.variables_get=function(a){return[Blockly.TIBasic.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),Blockly.TIBasic.ORDER_ATOMIC]};Blockly.TIBasic.variables_set=function(a){var b=Blockly.TIBasic.valueToCode(a,"VALUE",Blockly.TIBasic.ORDER_ASSIGNMENT)||"0";return Blockly.TIBasic.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE)+" := "+b+":"};